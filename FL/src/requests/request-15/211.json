{
  "Requests": [
    {
      "id": "allow_b9be7f63",
      "Effect": "allow",
      "Action": "ec2:DescribeVolumes",
      "Resource": "arn:aws:s3:::mybucket/file-11-3.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "not-domain"
        }
      }
    },
    {
      "id": "allow_06d80100",
      "Effect": "allow",
      "Action": "elasticloadbalancing:CreateLoadBalancer",
      "Resource": "arn:aws:s3:::mybucket/file-27-4.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_903d9292",
      "Effect": "allow",
      "Action": "sagemaker:ListTrainingJobs",
      "Resource": "arn:aws:s3:::mybucket/file-13-5.txt",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_e8c69d67",
      "Effect": "allow",
      "Action": "glue:StartCrawler",
      "Resource": "arn:aws:s3:::mybucket/file-6-18.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_9a447888",
      "Effect": "allow",
      "Action": "sagemaker:CreateTrainingJob",
      "Resource": "arn:aws:s3:::mybucket/file-46-19.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_3cdd1c78",
      "Effect": "allow",
      "Action": "kms:ListKeys",
      "Resource": "arn:aws:s3:::mybucket/file-10-15.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "deny_9327c0b4",
      "Effect": "deny",
      "Action": "s3:GetObjectVersion",
      "Resource": "arn:aws:s3:::different-mybucket/file.txt",
      "Principal": "ses.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "domain"
        },
        "StringLike": {
          "aws:Referer": "copied arn email@domain"
        }
      }
    },
    {
      "id": "deny_bf8a6331",
      "Effect": "deny",
      "Action": "sqs:SendMessage",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "ses.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "domain"
        },
        "StringLike": {
          "aws:Referer": "copied arn email@domain"
        }
      }
    },
    {
      "id": "allow_f81b655e",
      "Effect": "allow",
      "Action": "ec2:DetachVolume",
      "Resource": "arn:aws:s3:::mybucket/file-23-19.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "deny_118e7178",
      "Effect": "deny",
      "Action": "s3:DeleteBucketCors",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Principal": "ses.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "domain"
        },
        "StringLike": {
          "aws:Referer": "copied arn email@domain"
        }
      }
    },
    {
      "id": "deny_f02ee171",
      "Effect": "deny",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:s3:::mybucket-forbidden/file.txt",
      "Principal": "ses.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "domain"
        }
      }
    },
    {
      "id": "deny_2e196e82",
      "Effect": "deny",
      "Action": "s3:PutBucketVersioning",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "ses.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "domain"
        },
        "StringLike": {
          "aws:Referer": "copied arn email@domain"
        }
      }
    },
    {
      "id": "allow_6df8829d",
      "Effect": "allow",
      "Action": "route53:GetHostedZone",
      "Resource": "arn:aws:s3:::mybucket/file-48-10.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "not-domain"
        }
      }
    },
    {
      "id": "allow_58168e24",
      "Effect": "allow",
      "Action": "ec2:DescribeKeyPairs",
      "Resource": "arn:aws:s3:::mybucket/file-9-14.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_63ad5644",
      "Effect": "deny",
      "Action": "s3:PutObjectAcl",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "ses.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:Referer": "domain"
        },
        "StringLike": {
          "aws:Referer": "copied arn email@domain"
        }
      }
    }
  ]
}