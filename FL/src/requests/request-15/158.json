{
  "Requests": [
    {
      "id": "allow_642c5c73",
      "Effect": "allow",
      "Action": "iam:CreatePolicy",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_3ff7159e",
      "Effect": "allow",
      "Action": "iam:DeletePolicy",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_0cb29cc5",
      "Effect": "deny",
      "Action": "dynamodb:DeleteItem",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "sns.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "119690846692"
        }
      }
    },
    {
      "id": "allow_3e1a65e1",
      "Effect": "allow",
      "Action": "ses:SendRawEmail",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_1a450895",
      "Effect": "deny",
      "Action": "sqs:ListQueueTags",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue-forbidden-resource",
      "Principal": "sns.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "119690846692"
        }
      }
    },
    {
      "id": "allow_ab69ae30",
      "Effect": "allow",
      "Action": "codepipeline:ListPipelines",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_72a88297",
      "Effect": "allow",
      "Action": "guardduty:ListDetectors",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_50eb03b5",
      "Effect": "allow",
      "Action": "kms:GetKeyPolicy",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "not-119690846692"
        }
      }
    },
    {
      "id": "allow_4caf63fb",
      "Effect": "allow",
      "Action": "kms:EnableKey",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "not-119690846692"
        }
      }
    },
    {
      "id": "deny_2b3cb70a",
      "Effect": "deny",
      "Action": "sqs:DeleteQueue",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "sns.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "119690846692"
        }
      }
    },
    {
      "id": "deny_163ca331",
      "Effect": "deny",
      "Action": "sqs:GetQueueAttributes",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "sns.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "119690846692"
        }
      }
    },
    {
      "id": "allow_c4d8f67c",
      "Effect": "allow",
      "Action": "kms:CreateKey",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_c84f06f6",
      "Effect": "allow",
      "Action": "sagemaker:ListEndpointConfigs",
      "Resource": "arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_0343ac28",
      "Effect": "deny",
      "Action": "sqs:PurgeQueue",
      "Resource": "authorized/arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue/file.txt",
      "Principal": "sns.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "119690846692"
        }
      }
    },
    {
      "id": "deny_f15e31b5",
      "Effect": "deny",
      "Action": "sqs:ListDeadLetterSourceQueues",
      "Resource": "forbidden-arn:aws:sqs:eu-west-1:<YOUR_ACCOUNT_ID>:ams-eu-sp-traffic-queue-specific",
      "Principal": "sns.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "119690846692"
        }
      }
    }
  ]
}