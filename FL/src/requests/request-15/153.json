{
  "Requests": [
    {
      "id": "allow_8f430c3d",
      "Effect": "allow",
      "Action": "ec2:ModifyInstanceAttribute",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-2-16.txt",
      "Principal": "arn:aws:iam::550069211225:role/roletest1",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_1831e172",
      "Effect": "allow",
      "Action": "kms:RevokeGrant",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-27-13.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_3e1fcb1a",
      "Effect": "allow",
      "Action": "sqs:SendMessageBatch",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-22-5.txt",
      "Principal": "arn:aws:iam::123:role/forbidden-roletest1",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_b246f2a4",
      "Effect": "allow",
      "Action": "sqs:ListQueues",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-17-5.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      }
    },
    {
      "id": "deny_6e7ccb86",
      "Effect": "deny",
      "Action": "lambda:InvokeFunction",
      "Resource": "authorized/arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/*/file.txt",
      "Principal": "arn:aws:iam::123:role/roletest1",
      "Condition": {
        "StringLike": {
          "s3tables:TableNamespace": "namesptest"
        }
      }
    },
    {
      "id": "allow_f2b430d7",
      "Effect": "allow",
      "Action": "athena:GetQueryResults",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-49-16.txt",
      "Principal": "arn:aws:iam::418892945805:role/roletest1",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_cbbab109",
      "Effect": "deny",
      "Action": "lambda:CreateFunction",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "arn:aws:iam::123:role/roletest1",
      "Condition": {
        "StringLike": {
          "s3tables:TableNamespace": "namesptest"
        }
      }
    },
    {
      "id": "deny_d6e7fd30",
      "Effect": "deny",
      "Action": "rds:DeleteDBInstance",
      "Resource": "forbidden-arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/*-specific",
      "Principal": "arn:aws:iam::123:role/roletest1",
      "Condition": {
        "StringLike": {
          "s3tables:TableNamespace": "namesptest"
        }
      }
    },
    {
      "id": "allow_1c8b7152",
      "Effect": "allow",
      "Action": "kinesis:DeleteStream",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-10-8.txt",
      "Principal": "arn:aws:iam::123:role/forbidden-roletest1",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "allow_9d9b9ffa",
      "Effect": "allow",
      "Action": "sagemaker:CreateModel",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-5-4.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_e80695ce",
      "Effect": "allow",
      "Action": "config:PutConfigRule",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-25-6.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_d2581984",
      "Effect": "deny",
      "Action": "iam:DeleteUser",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "arn:aws:iam::123:role/roletest1",
      "Condition": {
        "StringLike": {
          "s3tables:TableNamespace": "namesptest"
        }
      }
    },
    {
      "id": "allow_cf4641c1",
      "Effect": "allow",
      "Action": "cloudtrail:StartLogging",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/file-23-4.txt",
      "Principal": "arn:aws:iam::433281737203:role/roletest1",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "deny_9b631721",
      "Effect": "deny",
      "Action": "sqs:ReceiveMessage",
      "Resource": "arn:aws:s3tables:us-west-2:123:table-bucket/tabletest/table/*-forbidden-resource",
      "Principal": "arn:aws:iam::123:role/roletest1",
      "Condition": {
        "StringLike": {
          "s3tables:TableNamespace": "namesptest"
        }
      }
    },
    {
      "id": "deny_7c599ab2",
      "Effect": "deny",
      "Action": "dynamodb:PutItem",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "arn:aws:iam::123:role/roletest1",
      "Condition": {
        "StringLike": {
          "s3tables:TableNamespace": "namesptest"
        }
      }
    }
  ]
}