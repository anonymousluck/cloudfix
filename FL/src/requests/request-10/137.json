{
  "Requests": [
    {
      "id": "deny_9c5214f3",
      "Effect": "deny",
      "Action": "s3:GetBucketLifecycle",
      "Resource": "forbidden-arn:aws:es:us-west-2:654654323652:domain/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%/_all/_settings-specific",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "kinesis.us-west-2.amazonaws.com"
        },
        "StringLike": {
          "kms:EncryptionContext:aws:kinesis:arn": "arn:aws:kinesis:us-west-2:654654323652:stream/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%"
        }
      },
      "Principal": "arn:aws:iam::999888777666:user/unauthorized"
    },
    {
      "id": "deny_77c88f48",
      "Effect": "deny",
      "Action": "s3:GetBucketCors",
      "Resource": "forbidden-arn:aws:kinesis:us-west-2:654654323652:stream/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%-specific",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "s3.us-west-2.amazonaws.com"
        },
        "StringLike": {
          "kms:EncryptionContext:aws:s3:arn": [
            "arn:aws:s3:::%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%/*",
            "arn:aws:s3:::%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/admin-role"
    },
    {
      "id": "allow_801e2fc5",
      "Effect": "allow",
      "Action": "cloudwatch:GetMetricData",
      "Resource": "arn:aws:s3:::bucket-34/file-5.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_f07f0e64",
      "Effect": "allow",
      "Action": "iam:DeleteAccessKey",
      "Resource": "arn:aws:s3:::demo-amazon-s3-bucket/file-44-16.txt",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "not-kinesis.us-west-2.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_da05d550",
      "Effect": "allow",
      "Action": "sagemaker:StopNotebookInstance",
      "Resource": "arn:aws:es:us-west-2:654654323652:domain/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%/file-32-16.txt",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "not-s3.us-west-2.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_ba6c4fb5",
      "Effect": "allow",
      "Action": "sagemaker:DescribeEndpointConfig",
      "Resource": "arn:aws:glue:us-east-1:123456789012:table/db-2/table-4",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_42dbcdb1",
      "Effect": "allow",
      "Action": "athena:GetWorkGroup",
      "Resource": "arn:aws:logs:us-west-2:654654323652:log-group:%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%:log-stream:resource-27-1",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_2a2c00a7",
      "Effect": "deny",
      "Action": "s3:DeleteBucket",
      "Resource": "authorized/arn:aws:es:us-west-2:654654323652:domain/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%/_nodes/*/stats/file.txt",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "kinesis.us-west-2.amazonaws.com"
        },
        "StringLike": {
          "kms:EncryptionContext:aws:kinesis:arn": "arn:aws:kinesis:us-west-2:654654323652:stream/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%"
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "deny_07f7fa12",
      "Effect": "deny",
      "Action": "logs:DeleteLogStream",
      "Resource": "arn:aws:es:us-west-2:654654323652:domain/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%/_stats-forbidden-resource",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "kinesis.us-west-2.amazonaws.com"
        },
        "StringLike": {
          "kms:EncryptionContext:aws:kinesis:arn": "arn:aws:kinesis:us-west-2:654654323652:stream/%FIREHOSE_POLICY_TEMPLATE_PLACEHOLDER%"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/test-role"
    },
    {
      "id": "allow_ea0bc093",
      "Effect": "allow",
      "Action": "s3:GetBucketCors",
      "Resource": "arn:aws:glue:us-east-1:123456789012:table/db-4/table-12",
      "Condition": {
        "StringEquals": {
          "kms:ViaService": "not-s3.us-west-2.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    }
  ]
}