{
  "Requests": [
    {
      "id": "allow_a9cd866d",
      "Effect": "allow",
      "Action": "s3:GetBucketTagging",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_4aba7c15",
      "Effect": "allow",
      "Action": "codebuild:ListBuilds",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_986b5412",
      "Effect": "allow",
      "Action": "ec2:DeleteKeyPair",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_cb287048",
      "Effect": "allow",
      "Action": "codebuild:BatchGetBuilds",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_550c598c",
      "Effect": "deny",
      "Action": "ec2:DescribeInstances",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": [
            "part123"
          ],
          "dynamodb:Attributes": [
            "mykey",
            "mymap"
          ]
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "allow_2c1f3398",
      "Effect": "allow",
      "Action": "kms:ListGrants",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_11fcf2be",
      "Effect": "allow",
      "Action": "elasticbeanstalk:DeleteApplication",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_51c8b660",
      "Effect": "allow",
      "Action": "iam:AddUserToGroup",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_3d15daeb",
      "Effect": "deny",
      "Action": "iam:DeleteUser",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": [
            "part123"
          ],
          "dynamodb:Attributes": [
            "mykey",
            "mymap"
          ]
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "allow_a6b77288",
      "Effect": "allow",
      "Action": "codedeploy:GetDeployment",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "deny_f426bd42",
      "Effect": "deny",
      "Action": "dynamodb:Scan",
      "Resource": "forbidden-arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>-specific",
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": [
            "part123"
          ],
          "dynamodb:Attributes": [
            "mykey",
            "mymap"
          ]
        }
      },
      "Principal": "arn:aws:iam::111222333444:role/developer-role"
    },
    {
      "id": "deny_25625025",
      "Effect": "deny",
      "Action": "dynamodb:Query",
      "Resource": "authorized/arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>/file.txt",
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": [
            "part123"
          ],
          "dynamodb:Attributes": [
            "mykey",
            "mymap"
          ]
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "deny_16d91c7c",
      "Effect": "deny",
      "Action": "sns:Publish",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": [
            "part123"
          ],
          "dynamodb:Attributes": [
            "mykey",
            "mymap"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/test-user"
    },
    {
      "id": "deny_cd3cf8b5",
      "Effect": "deny",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>-forbidden-resource",
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": [
            "part123"
          ],
          "dynamodb:Attributes": [
            "mykey",
            "mymap"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/test-user"
    },
    {
      "id": "allow_42a9c5ed",
      "Effect": "allow",
      "Action": "s3:PutBucketWebsite",
      "Resource": "arn:aws:dynamodb:*:<ACCOUNT>:table/<TABLE>",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    }
  ]
}