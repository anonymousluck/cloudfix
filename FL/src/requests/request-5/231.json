{
  "Requests": [
    {
      "id": "deny_aaecc3c9",
      "Effect": "deny",
      "Action": "kms:ScheduleKeyDeletion",
      "Resource": "arn:aws:s3:::forbidden-bucket/file.txt",
      "Condition": {
        "NumericLessThan": {
          "s3:max-keys": "10"
        }
      }
    },
    {
      "id": "allow_46eb3028",
      "Effect": "allow",
      "Action": [
        "kms:TagResource",
        "kms:CreateKey"
      ],
      "Resource": [
        "arn:aws:s3:::data-bucket/file.json",
        "arn:aws:s3:::my-bucket/document.txt"
      ],
      "Condition": {
        "StringEquals": {
          "aws:ResourceTag/Name": "demo"
        }
      }
    },
    {
      "id": "deny_fb35f559",
      "Effect": "deny",
      "Action": "kms:TagResource",
      "Resource": "arn:aws:s3:::forbidden-bucket/file.txt",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "192.168.1.0/24"
        }
      }
    },
    {
      "id": "allow_5bb35c76",
      "Effect": "allow",
      "Action": [
        "kms:ScheduleKeyDeletion",
        "kms:TagResource"
      ],
      "Resource": [
        "arn:aws:kms:*:486555357186:key/document.txt",
        "arn:aws:s3:::data-bucket/file.json"
      ],
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "allow_1a58c402",
      "Effect": "allow",
      "Action": [
        "kms:TagResource",
        "kms:ScheduleKeyDeletion"
      ],
      "Resource": [
        "arn:aws:s3:::my-bucket/document.txt",
        "arn:aws:kms:*:486555357186:key/data.json"
      ],
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "192.168.1.0/24"
        }
      }
    }
  ]
}