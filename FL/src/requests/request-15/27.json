{
  "Requests": [
    {
      "id": "deny_20d75979",
      "Effect": "deny",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "cloudtrail.amazonaws.com",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "id": "allow_6dbed938",
      "Effect": "allow",
      "Action": "sqs:GetQueueAttributes",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-40-7.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "id": "allow_6bac68cd",
      "Effect": "allow",
      "Action": "glue:GetTable",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-17-19.txt",
      "Principal": "arn:aws:iam::123456789012:role/test-role",
      "Condition": {
        "StringEquals": {
          "AWS:SourceArn": "not-arn:aws:cloudtrail:us-east-2:111222333:trail/CloudTrail_WorkdayAdaptiveCP_S3_Events"
        }
      }
    },
    {
      "id": "deny_9d255a52",
      "Effect": "deny",
      "Action": "sns:Publish",
      "Resource": "arn:aws:s3:::workday-adaptive-cp-forbidden/file.txt",
      "Principal": "arn:aws:iam::123456789012:user/temp-user",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "id": "deny_ef9e3d6e",
      "Effect": "deny",
      "Action": "ec2:RunInstances",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringNotEquals": {
          "s3:x-amz-server-side-encryption": "aws:kms"
        }
      }
    },
    {
      "id": "allow_ec1f6775",
      "Effect": "allow",
      "Action": "s3:PutBucketTagging",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-9-2.txt",
      "Principal": "arn:aws:iam::123456789012:user/test-user",
      "Condition": {
        "StringEquals": {
          "s3:x-amz-server-side-encryption": "not-AES256"
        }
      }
    },
    {
      "id": "allow_c4279ead",
      "Effect": "allow",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-36-7.txt",
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "not-111222333"
        }
      }
    },
    {
      "id": "allow_25d06556",
      "Effect": "allow",
      "Action": "cloudwatch:DeleteDashboards",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-18-6.txt",
      "Principal": "arn:aws:iam::123456789012:user/test-user",
      "Condition": {
        "StringEquals": {
          "s3:x-amz-acl": "not-bucket-owner-full-control"
        }
      }
    },
    {
      "id": "allow_7dfa26bf",
      "Effect": "allow",
      "Action": "sagemaker:DescribeEndpointConfig",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/CloudTrail_S3_Events/AWSLogs/111222333/file-48-0.txt",
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role",
      "Condition": {
        "StringEquals": {
          "AWS:SourceArn": "not-arn:aws:cloudtrail:us-east-2:111222333:trail/CloudTrail_WorkdayAdaptiveCP_S3_Events"
        }
      }
    },
    {
      "id": "deny_f318cbd4",
      "Effect": "deny",
      "Action": "sqs:ReceiveMessage",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "logging.s3.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "AWS:SourceArn": "arn:aws:cloudtrail:us-east-2:111222333:trail/CloudTrail_WorkdayAdaptiveCP_S3_Events"
        }
      }
    },
    {
      "id": "allow_7496ec1c",
      "Effect": "allow",
      "Action": "sqs:UntagQueue",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-17-13.txt",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "id": "deny_1667041f",
      "Effect": "deny",
      "Action": "iam:CreateUser",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Principal": "arn:aws:iam::123456789012:role/test-role",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "id": "allow_40735b90",
      "Effect": "allow",
      "Action": "athena:GetQueryResults",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/file-24-13.txt",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "StringEquals": {
          "s3:x-amz-server-side-encryption": "not-AES256"
        }
      }
    },
    {
      "id": "deny_aafe81b1",
      "Effect": "deny",
      "Action": "dynamodb:PutItem",
      "Resource": "arn:aws:s3:::different-workday-adaptive-cp/file.txt",
      "Principal": "cloudtrail.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "s3:x-amz-server-side-encryption": "AES256"
        }
      }
    },
    {
      "id": "allow_37ae58c1",
      "Effect": "allow",
      "Action": "logs:DeleteLogStream",
      "Resource": "arn:aws:s3:::workday-adaptive-cp/CloudTrail_S3_Events/AWSLogs/111222333/file-33-18.txt",
      "Principal": "arn:aws:iam::123456789012:role/forbidden-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    }
  ]
}