{
  "Requests": [
    {
      "id": "allow_fc037f9f",
      "Effect": "allow",
      "Action": "athena:GetDatabase",
      "Resource": "arn:aws:glue:us-east-1:123456789012:table/db-17/table-13",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_c96a3d04",
      "Effect": "allow",
      "Action": "ec2:ImportKeyPair",
      "Resource": "arn:aws:ssm:*:*:session/${aws:userid}-resource-36-11",
      "Condition": {
        "StringEquals": {
          "ssm:resourceTag/host": "not-our-rds.yyyyyyyyyyyy.ap-southeast-1.rds.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_bac19d10",
      "Effect": "allow",
      "Action": "iam:GetRolePolicy",
      "Resource": "arn:aws:ssm:*:*:session/${aws:userid}-resource-16-3",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_f111f27a",
      "Effect": "allow",
      "Action": "sqs:ChangeMessageVisibilityBatch",
      "Resource": "arn:aws:ssm:*:*:session/${aws:userid}-resource-6-0",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_1e0d0d52",
      "Effect": "allow",
      "Action": "logs:DeleteLogStream",
      "Resource": "arn:aws:s3:::bucket-2/file-8.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_b8d6f156",
      "Effect": "allow",
      "Action": "iam:ListRoles",
      "Resource": "arn:aws:s3:::bucket-43/file-1.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "deny_4084e034",
      "Effect": "deny",
      "Action": "sqs:ReceiveMessage",
      "Resource": "arn:aws:ec2:ap-southeast-1:111111111111:instance/i-yyyyyyyyyyyyyyyyy-forbidden-resource",
      "Condition": {
        "StringEquals": {
          "ssm:resourceTag/host": "our-rds.yyyyyyyyyyyy.ap-southeast-1.rds.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::999888777666:user/unauthorized"
    },
    {
      "id": "deny_113caf38",
      "Effect": "deny",
      "Action": "iam:CreateUser",
      "Resource": "arn:aws:ssm:ap-southeast-1::document/AWS-StartPortForwardingSessionToRemoteHost-forbidden-resource",
      "Condition": {
        "StringEquals": {
          "ssm:resourceTag/host": "our-rds.yyyyyyyyyyyy.ap-southeast-1.rds.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/blocked-user"
    },
    {
      "id": "deny_c1f490ab",
      "Effect": "deny",
      "Action": "dynamodb:PutItem",
      "Resource": "arn:aws:iam::123456789012:role/admin-role",
      "Condition": {
        "StringEquals": {
          "ssm:resourceTag/host": "our-rds.yyyyyyyyyyyy.ap-southeast-1.rds.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role"
    },
    {
      "id": "deny_5a270086",
      "Effect": "deny",
      "Action": "sqs:SendMessage",
      "Resource": "authorized/arn:aws:ssm:*:*:session/${aws:userid}-*/file.txt",
      "Condition": {
        "StringEquals": {
          "ssm:resourceTag/host": "our-rds.yyyyyyyyyyyy.ap-southeast-1.rds.amazonaws.com"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/test-user"
    }
  ]
}