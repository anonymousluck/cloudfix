{
  "Requests": [
    {
      "id": "deny_9f7c6367",
      "Effect": "deny",
      "Action": "s3:DeleteBucketLifecycle",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "arn:aws:iam::111222333444:user/david",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_7fb98a66",
      "Effect": "allow",
      "Action": "glue:CreateTable",
      "Resource": "arn:aws:s3:::resource-23-5",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_c5b8cb29",
      "Effect": "allow",
      "Action": "codebuild:ListBuilds",
      "Resource": "arn:aws:s3:::resource-3-19",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_4ad82abd",
      "Effect": "allow",
      "Action": "iam:GetAccessKeyLastUsed",
      "Resource": "arn:aws:s3:::resource-45-4",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_83009381",
      "Effect": "allow",
      "Action": "workspaces:CreateWorkspaces",
      "Resource": "arn:aws:s3:::resource-31-13",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_58fd1435",
      "Effect": "allow",
      "Action": "s3:ListObjectVersions",
      "Resource": "arn:aws:s3:::resource-23-1",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_cd5a97e6",
      "Effect": "allow",
      "Action": "s3:PutBucketTagging",
      "Resource": "arn:aws:s3:::resource-24-3",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_35910bbf",
      "Effect": "deny",
      "Action": "s3:GetBucketVersioning",
      "Resource": "arn:aws:s3:::denied-bucket-3/file-3.txt",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "StringEquals": {
          "s3:ExistingObjectTag/Department": "Finance"
        }
      }
    },
    {
      "id": "deny_8b8e67b9",
      "Effect": "deny",
      "Action": "s3:RestoreObject",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "arn:aws:iam::123456789012:user/test-user",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "true"
        }
      }
    },
    {
      "id": "deny_72ae25e2",
      "Effect": "deny",
      "Action": "s3:GetBucketCors",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "arn:aws:iam::111222333444:role/developer-role",
      "Condition": {
        "StringEquals": {
          "s3:ExistingObjectTag/Department": "Finance"
        }
      }
    },
    {
      "id": "allow_601e23c8",
      "Effect": "allow",
      "Action": "guardduty:ListDetectors",
      "Resource": "arn:aws:s3:::resource-17-4",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_98a35a64",
      "Effect": "deny",
      "Action": "dynamodb:DeleteItem",
      "Resource": "arn:aws:s3:::denied-bucket-5/file-5.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_b1e7bebd",
      "Effect": "allow",
      "Action": "ec2:CreateTags",
      "Resource": "arn:aws:s3:::resource-30-6",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_2bf6ddaf",
      "Effect": "deny",
      "Action": "s3:ListObjectVersions",
      "Resource": "arn:aws:s3:::denied-bucket-4/file-4.txt",
      "Principal": "arn:aws:iam::111222333444:role/developer-role",
      "Condition": {
        "StringEquals": {
          "s3:ExistingObjectTag/Department": "Finance"
        }
      }
    },
    {
      "id": "allow_c92c0e10",
      "Effect": "allow",
      "Action": "kms:ListGrants",
      "Resource": "arn:aws:s3:::resource-3-11",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    }
  ]
}