{
  "Requests": [
    {
      "id": "allow_8842bf61",
      "Effect": "allow",
      "Action": "cloudtrail:DeleteTrail",
      "Resource": "arn:aws:s3:::mytestbucket/file-4-2.txt",
      "Principal": "arn:aws:iam::759964541692:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_12ada3a1",
      "Effect": "allow",
      "Action": "s3:PutBucketWebsite",
      "Resource": "arn:aws:s3:::mytestbucket/file-38-16.txt",
      "Principal": "arn:aws:iam::279964328921:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_1c471996",
      "Effect": "allow",
      "Action": "sqs:DeleteMessageBatch",
      "Resource": "arn:aws:s3:::mytestbucket/file-42-19.txt",
      "Principal": "arn:aws:iam::239409934064:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_247e58c2",
      "Effect": "allow",
      "Action": "logs:DeleteLogStream",
      "Resource": "arn:aws:s3:::mytestbucket/file-41-17.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/forbidden-codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_a0cab08b",
      "Effect": "deny",
      "Action": "dynamodb:PutItem",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_76a939a9",
      "Effect": "deny",
      "Action": "sns:Publish",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "NumericLessThan": {
          "s3:max-keys": "10"
        }
      }
    },
    {
      "id": "allow_420b4c93",
      "Effect": "allow",
      "Action": "es:DescribeElasticsearchDomains",
      "Resource": "arn:aws:s3:::mytestbucket/file-11-16.txt",
      "Principal": "arn:aws:iam::856134244797:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_e6c367f0",
      "Effect": "deny",
      "Action": "lambda:CreateFunction",
      "Resource": "arn:aws:s3:::mytestbucket-forbidden/file.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "true"
        }
      }
    },
    {
      "id": "deny_cf9121a3",
      "Effect": "deny",
      "Action": "ec2:DescribeInstances",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "allow_78263e2e",
      "Effect": "allow",
      "Action": "cloudwatch:DescribeAlarms",
      "Resource": "arn:aws:s3:::mytestbucket/file-23-15.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/forbidden-codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_3e19c2dd",
      "Effect": "allow",
      "Action": "elasticloadbalancing:CreateLoadBalancer",
      "Resource": "arn:aws:s3:::mytestbucket/file-49-9.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_99598989",
      "Effect": "allow",
      "Action": "glue:GetCrawler",
      "Resource": "arn:aws:s3:::mytestbucket/file-43-11.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_d733bd23",
      "Effect": "allow",
      "Action": "s3:DeleteBucketTagging",
      "Resource": "arn:aws:s3:::mytestbucket/file-24-9.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_157ed1cf",
      "Effect": "deny",
      "Action": "iam:CreateUser",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_c880f664",
      "Effect": "deny",
      "Action": "iam:DeleteUser",
      "Resource": "arn:aws:s3:::different-mytestbucket/file.txt",
      "Principal": "arn:aws:iam::[account A]:role/service-role/codebuild-service-role-foo-bar",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      }
    }
  ]
}