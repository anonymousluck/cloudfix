{
  "Requests": [
    {
      "id": "deny_5f490a15",
      "Effect": "deny",
      "Action": "dynamodb:PutItem",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Condition": {
        "StringLike": {
          "iot:Connection.Thing.Attributes[department_id]": "${aws:PrincipalTag/department}"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/blocked-user"
    },
    {
      "id": "allow_815e51b1",
      "Effect": "allow",
      "Action": "logs:DescribeLogGroups",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-20-1",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "deny_da8400e7",
      "Effect": "deny",
      "Action": "sns:Publish",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Condition": {
        "StringLike": {
          "iot:Connection.Thing.Attributes[department_id]": "${aws:PrincipalTag/department}"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_85b5d885",
      "Effect": "allow",
      "Action": "sagemaker:DeleteNotebookInstance",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-39-15",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_8ac8cf6e",
      "Effect": "allow",
      "Action": "s3:PutBucketLifecycle",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-49-15",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_31e226a9",
      "Effect": "allow",
      "Action": "codepipeline:GetPipeline",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-35-12",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_205621bf",
      "Effect": "deny",
      "Action": "ec2:RunInstances",
      "Resource": "forbidden-arn:aws:iot:ap-southeast-2:<accountId>:*-specific",
      "Condition": {
        "StringLike": {
          "iot:Connection.Thing.Attributes[department_id]": "${aws:PrincipalTag/department}"
        }
      },
      "Principal": "arn:aws:iam::111222333444:role/developer-role"
    },
    {
      "id": "allow_a1df2108",
      "Effect": "allow",
      "Action": "codedeploy:GetDeployment",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-26-2",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_b5f0825c",
      "Effect": "allow",
      "Action": "sagemaker:DescribeEndpoint",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-15-1",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "deny_4da958b5",
      "Effect": "deny",
      "Action": "rds:CreateDBInstance",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Condition": {
        "StringLike": {
          "iot:Connection.Thing.Attributes[department_id]": "${aws:PrincipalTag/department}"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/blocked-user"
    },
    {
      "id": "allow_11e4dd1c",
      "Effect": "allow",
      "Action": "es:DescribeElasticsearchDomains",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-7-14",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_3cb2e425",
      "Effect": "deny",
      "Action": "lambda:InvokeFunction",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:*-forbidden-resource",
      "Condition": {
        "StringLike": {
          "iot:Connection.Thing.Attributes[department_id]": "${aws:PrincipalTag/department}"
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "deny_88f2c5ba",
      "Effect": "deny",
      "Action": "ec2:DescribeInstances",
      "Resource": "authorized/arn:aws:iot:ap-southeast-2:<accountId>:*/file.txt",
      "Condition": {
        "StringLike": {
          "iot:Connection.Thing.Attributes[department_id]": "${aws:PrincipalTag/department}"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_960ec9ad",
      "Effect": "allow",
      "Action": "ses:ListIdentities",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-44-11",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_e7d658c3",
      "Effect": "allow",
      "Action": "kms:UpdateKeyDescription",
      "Resource": "arn:aws:iot:ap-southeast-2:<accountId>:resource-31-14",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    }
  ]
}