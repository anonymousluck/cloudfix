{
  "Requests": [
    {
      "id": "allow_02fddf2d",
      "Effect": "allow",
      "Action": "kms:CreateGrant",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-20-15.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "deny_b39a2fe6",
      "Effect": "deny",
      "Action": "ec2:RunInstances",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "arn:aws:iam::ACCOUNT_A:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "ACCOUNT_A"
        }
      }
    },
    {
      "id": "allow_e3aa6d9c",
      "Effect": "allow",
      "Action": "cloudtrail:CreateTrail",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-16-17.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "deny_be729390",
      "Effect": "deny",
      "Action": "rds:DeleteDBInstance",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "bedrock.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "ACCOUNT_A"
        }
      }
    },
    {
      "id": "deny_7601f4b0",
      "Effect": "deny",
      "Action": "iam:DeleteUser",
      "Resource": "arn:aws:s3:::different-account_b_bucket_name/file.txt",
      "Principal": "arn:aws:iam::ACCOUNT_A:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "ACCOUNT_A"
        }
      }
    },
    {
      "id": "deny_44c79d62",
      "Effect": "deny",
      "Action": "lambda:CreateFunction",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Principal": "arn:aws:iam::ACCOUNT_A:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "ACCOUNT_A"
        }
      }
    },
    {
      "id": "deny_a3279713",
      "Effect": "deny",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:s3:::account_b_bucket_name-forbidden/file.txt",
      "Principal": "bedrock.amazonaws.com",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "ACCOUNT_A"
        }
      }
    },
    {
      "id": "allow_5e8c7053",
      "Effect": "allow",
      "Action": "codebuild:ListBuilds",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-21-15.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "not-ACCOUNT_A"
        }
      }
    },
    {
      "id": "allow_7ad1106e",
      "Effect": "allow",
      "Action": "cloudwatch:DeleteDashboards",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-24-16.txt",
      "Principal": "arn:aws:iam::425349237661:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_971e2e52",
      "Effect": "allow",
      "Action": "lambda:DeleteFunction",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-14-17.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "allow_d530ff27",
      "Effect": "allow",
      "Action": "glue:BatchGetJobs",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-21-16.txt",
      "Principal": "arn:aws:iam::648106415528:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_05fd5183",
      "Effect": "allow",
      "Action": "workspaces:CreateWorkspaces",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-24-9.txt",
      "Principal": "arn:aws:iam::228313386725:role/lambda_execution_role",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "deny_3dd5c704",
      "Effect": "deny",
      "Action": "lambda:InvokeFunction",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "arn:aws:iam::ACCOUNT_A:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:SourceAccount": "ACCOUNT_A"
        }
      }
    },
    {
      "id": "allow_2e851766",
      "Effect": "allow",
      "Action": "glue:StartCrawler",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-41-13.txt",
      "Principal": "arn:aws:iam::980138659233:role/lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_c574241f",
      "Effect": "allow",
      "Action": "iam:ListGroupsForUser",
      "Resource": "arn:aws:s3:::account_b_bucket_name/file-11-13.txt",
      "Principal": "arn:aws:iam::ACCOUNT_A:role/forbidden-lambda_execution_role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    }
  ]
}