{
  "Requests": [
    {
      "id": "deny_e5738e43",
      "Effect": "deny",
      "Action": "s3:PutBucketCors",
      "Resource": "arn:aws:s3:::different-mybucket/file.txt",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringLike": {
          "aws:Referer": [
            "https://example.com/*",
            "https://example.com"
          ]
        }
      }
    },
    {
      "id": "allow_0f6da930",
      "Effect": "allow",
      "Action": "iam:ListGroupsForUser",
      "Resource": "arn:aws:s3:::mybucket/file-23-0.txt",
      "Principal": "arn:aws:iam::123456789012:user/test-user",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      }
    },
    {
      "id": "allow_61968046",
      "Effect": "allow",
      "Action": "kms:GenerateDataKeyWithoutPlaintext",
      "Resource": "arn:aws:s3:::mybucket/file-22-5.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_2b8570b9",
      "Effect": "allow",
      "Action": "s3:PutBucketWebsite",
      "Resource": "arn:aws:s3:::mybucket/file-25-11.txt",
      "Principal": "arn:aws:iam::123456789012:role/forbidden-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "deny_1f50aac4",
      "Effect": "deny",
      "Action": "s3:DeleteObjectTagging",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Principal": "arn:aws:iam::111222333444:role/developer-role",
      "Condition": {
        "StringLike": {
          "aws:Referer": [
            "https://example.com/*",
            "https://example.com"
          ]
        }
      }
    },
    {
      "id": "allow_f6f08283",
      "Effect": "allow",
      "Action": "autoscaling:CreateAutoScalingGroup",
      "Resource": "arn:aws:s3:::mybucket/file-6-15.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "allow_1bb0b261",
      "Effect": "allow",
      "Action": "guardduty:CreateDetector",
      "Resource": "arn:aws:s3:::mybucket/file-17-9.txt",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "allow_17b66f20",
      "Effect": "allow",
      "Action": "ec2:ImportKeyPair",
      "Resource": "arn:aws:s3:::mybucket/file-21-8.txt",
      "Principal": "arn:aws:iam::123456789012:role/test-role",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      }
    },
    {
      "id": "allow_0a0bb62b",
      "Effect": "allow",
      "Action": "codebuild:StopBuild",
      "Resource": "arn:aws:s3:::mybucket/file-20-14.txt",
      "Principal": "arn:aws:iam::123456789012:role/forbidden-role",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      }
    },
    {
      "id": "deny_7773eeb1",
      "Effect": "deny",
      "Action": "s3:PutBucketWebsite",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "StringLike": {
          "aws:Referer": [
            "https://example.com/*",
            "https://example.com"
          ]
        }
      }
    },
    {
      "id": "deny_92a64e21",
      "Effect": "deny",
      "Action": "s3:PutBucketLifecycle",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "arn:aws:iam::123456789012:user/test-user",
      "Condition": {
        "StringLike": {
          "aws:Referer": [
            "https://example.com/*",
            "https://example.com"
          ]
        }
      }
    },
    {
      "id": "deny_7a87b0c1",
      "Effect": "deny",
      "Action": "s3:GetObjectAcl",
      "Resource": "arn:aws:s3:::mybucket-forbidden/file.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "StringLike": {
          "aws:Referer": [
            "https://example.com/*",
            "https://example.com"
          ]
        }
      }
    },
    {
      "id": "allow_805919a8",
      "Effect": "allow",
      "Action": "kms:EnableKey",
      "Resource": "arn:aws:s3:::mybucket/file-10-14.txt",
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_ddc86a09",
      "Effect": "deny",
      "Action": "s3:GetObjectTagging",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Principal": "arn:aws:iam::123456789012:role/test-role",
      "Condition": {
        "StringLike": {
          "aws:Referer": [
            "https://example.com/*",
            "https://example.com"
          ]
        }
      }
    },
    {
      "id": "allow_2e9c4d38",
      "Effect": "allow",
      "Action": "iam:PutRolePolicy",
      "Resource": "arn:aws:s3:::mybucket/file-5-10.txt",
      "Principal": "arn:aws:iam::111222333444:user/temp-user",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    }
  ]
}