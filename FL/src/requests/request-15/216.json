{
  "Requests": [
    {
      "id": "deny_f8289bf9",
      "Effect": "deny",
      "Action": "iam:GetUser",
      "Resource": "arn:aws:s3:::regional-lambda-bucket-forbidden/file.txt",
      "Principal": "arn:aws:iam::111222333444:user/david",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      }
    },
    {
      "id": "deny_5cfbd90f",
      "Effect": "deny",
      "Action": "s3:DeleteBucketPolicy",
      "Resource": "arn:aws:s3:::datalake-published-data-forbidden/file.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_0ece2bbe",
      "Effect": "allow",
      "Action": "sqs:GetQueueAttributes",
      "Resource": "arn:aws:s3:::datalake-submissions/file-20-10.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_676e421e",
      "Effect": "allow",
      "Action": "s3:DeleteBucketTagging",
      "Resource": "arn:aws:s3:::datalake-athena-query-results/file-13-18.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    },
    {
      "id": "allow_71c5da0e",
      "Effect": "allow",
      "Action": "firehose:PutRecordBatch",
      "Resource": "arn:aws:s3:::datalake-athena-query-results/file-28-6.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_d3827e18",
      "Effect": "allow",
      "Action": "cloud9:DeleteEnvironment",
      "Resource": "arn:aws:s3:::datalake-submissions/file-33-15.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_777142b5",
      "Effect": "allow",
      "Action": "athena:GetWorkGroup",
      "Resource": "arn:aws:s3:::bucket-2/file-0.txt",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "deny_3d7024df",
      "Effect": "deny",
      "Action": "rds:DeleteDBInstance",
      "Resource": "arn:aws:s3:::different-datalake-curated-datasets/file.txt",
      "Principal": "arn:aws:iam::111222333444:role/developer-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "deny_58df228b",
      "Effect": "deny",
      "Action": "iam:GetRolePolicy",
      "Resource": "arn:aws:s3:::different-datalake-submissions/file.txt",
      "Principal": "arn:aws:iam::123456789012:role/test-role",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "true"
        }
      }
    },
    {
      "id": "deny_e8ded320",
      "Effect": "deny",
      "Action": "s3:DeleteBucketTagging",
      "Resource": "arn:aws:s3:::datalake-submissions-forbidden/file.txt",
      "Principal": "arn:aws:iam::999888777666:user/unauthorized",
      "Condition": {
        "StringEquals": {
          "s3:ExistingObjectTag/Department": "Finance"
        }
      }
    },
    {
      "id": "deny_22a096cd",
      "Effect": "deny",
      "Action": "dynamodb:PutItem",
      "Resource": "arn:aws:iam::123456789012:role/admin-role",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "NumericLessThan": {
          "s3:max-keys": "10"
        }
      }
    },
    {
      "id": "allow_3dfd21d4",
      "Effect": "allow",
      "Action": "lambda:ListFunctions",
      "Resource": "arn:aws:s3:::datalake-published-data/file-22-1.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      }
    },
    {
      "id": "allow_1e06c7a6",
      "Effect": "allow",
      "Action": "ec2:StartInstances",
      "Resource": "arn:aws:s3:::regional-lambda-bucket/file-36-8.txt",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_9a0d40b0",
      "Effect": "allow",
      "Action": "sagemaker:DescribeNotebookInstance",
      "Resource": "arn:aws:s3:::regional-lambda-bucket/file-21-17.txt",
      "Principal": "arn:aws:iam::123456789012:role/service-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_22d7441c",
      "Effect": "allow",
      "Action": "iam:UpdateLoginProfile",
      "Resource": "arn:aws:s3:::regional-lambda-bucket/file-19-7.txt",
      "Principal": "arn:aws:iam::123456789012:user/bob",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      }
    }
  ]
}