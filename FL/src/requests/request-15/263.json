{
  "Requests": [
    {
      "id": "deny_8d761a4f",
      "Effect": "deny",
      "Action": "s3:PutBucketWebsite",
      "Resource": "arn:aws:s3:::different-sftp-demo2/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:UserName}/*",
            "test-transferfamily-demo/${transfer:UserName}/*",
            "sftp-demo2/${transfer:UserName}/*"
          ]
        }
      },
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role"
    },
    {
      "id": "deny_84b4d02c",
      "Effect": "deny",
      "Action": "s3:GetBucketWebsite",
      "Resource": "arn:aws:s3:::test-transferfamily-demo-forbidden/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:UserName}/*",
            "test-transferfamily-demo/${transfer:UserName}/*",
            "sftp-demo2/${transfer:UserName}/*"
          ]
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "deny_82f3f998",
      "Effect": "deny",
      "Action": "s3:DeleteBucket",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:UserName}/*",
            "test-transferfamily-demo/${transfer:UserName}/*",
            "sftp-demo2/${transfer:UserName}/*"
          ]
        }
      },
      "Principal": "arn:aws:iam::111222333444:user/david"
    },
    {
      "id": "allow_f9c7794d",
      "Effect": "allow",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:s3:::sftp-demo2/${transfer:UserName}/file-42-0.txt",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_a330eb90",
      "Effect": "deny",
      "Action": "sns:Subscribe",
      "Resource": "arn:aws:s3:::sftp-demo2-forbidden/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:UserName}/*",
            "test-transferfamily-demo/${transfer:UserName}/*",
            "sftp-demo2/${transfer:UserName}/*"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/blocked-user"
    },
    {
      "id": "deny_953120fd",
      "Effect": "deny",
      "Action": "iam:DeleteUser",
      "Resource": "arn:aws:s3:::different-test-transferfamily-demo/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:UserName}/*",
            "test-transferfamily-demo/${transfer:UserName}/*",
            "sftp-demo2/${transfer:UserName}/*"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/test-role"
    },
    {
      "id": "allow_c55ce9b6",
      "Effect": "allow",
      "Action": "redshift:DeleteCluster",
      "Resource": "arn:aws:s3:::test-transferfamily-demo/${transfer:UserName}/file-22-1.txt",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_831ee89d",
      "Effect": "allow",
      "Action": "s3:GetObjectVersion",
      "Resource": "arn:aws:s3:::sftp-demo2/${transfer:UserName}/file-45-9.txt",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_78fe01fa",
      "Effect": "deny",
      "Action": "s3:GetObjectVersion",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:UserName}/*",
            "test-transferfamily-demo/${transfer:UserName}/*",
            "sftp-demo2/${transfer:UserName}/*"
          ]
        }
      },
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role"
    },
    {
      "id": "allow_d6581cf4",
      "Effect": "allow",
      "Action": "config:GetComplianceDetailsByConfigRule",
      "Resource": "arn:aws:s3:::sftp-demo2/${transfer:UserName}/file-45-4.txt",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_75df41be",
      "Effect": "allow",
      "Action": "kinesis:CreateStream",
      "Resource": "arn:aws:s3:::test-transferfamily-demo/${transfer:UserName}/file-42-10.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_ff57c50e",
      "Effect": "allow",
      "Action": "ec2:CreateVolume",
      "Resource": "arn:aws:s3:::sftp-demo2/${transfer:UserName}/file-40-9.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_c14feefd",
      "Effect": "allow",
      "Action": "ec2:RevokeSecurityGroupIngress",
      "Resource": "arn:aws:s3:::test-transferfamily-demo/${transfer:UserName}/file-33-15.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_a5879e42",
      "Effect": "allow",
      "Action": "ses:DeleteIdentity",
      "Resource": "arn:aws:s3:::test-transferfamily-demo/${transfer:UserName}/file-10-14.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_ff3437c2",
      "Effect": "allow",
      "Action": "codedeploy:ListDeployments",
      "Resource": "arn:aws:s3:::sftp-demo2/${transfer:UserName}/file-48-7.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    }
  ]
}