{
  "Requests": [
    {
      "id": "deny_c95ed506",
      "Effect": "deny",
      "Action": "iam:DeleteUser",
      "Resource": "arn:aws:iam::123456789012:role/admin-role",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/eks:eks-cluster-name": "${aws:PrincipalTag/eks:eks-cluster-name}"
        },
        "StringLike": {
          "aws:RequestTag/eks:kubernetes-node-class-name": "*",
          "aws:RequestTag/eks:kubernetes-node-pool-name": "*"
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "allow_b777dae4",
      "Effect": "allow",
      "Action": "s3:PutBucketCors",
      "Resource": "arn:aws:s3:::bucket-47/file-2.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_5beab664",
      "Effect": "allow",
      "Action": "s3:DeleteBucket",
      "Resource": "arn:aws:s3:::bucket-31/file-3.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_e0768845",
      "Effect": "allow",
      "Action": "guardduty:CreateIPSet",
      "Resource": "arn:aws:s3:::bucket-36/file-8.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_5aec2593",
      "Effect": "allow",
      "Action": "glue:BatchGetJobs",
      "Resource": "arn:aws:s3:::bucket-26/file-7.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_e051a749",
      "Effect": "deny",
      "Action": "ec2:StopInstances",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/eks:eks-cluster-name": "${aws:PrincipalTag/eks:eks-cluster-name}"
        },
        "StringLike": {
          "aws:RequestTag/eks:kubernetes-node-class-name": "*",
          "aws:RequestTag/eks:kubernetes-node-pool-name": "*"
        }
      },
      "Principal": "arn:aws:iam::987654321098:user/charlie"
    },
    {
      "id": "allow_8c48ab42",
      "Effect": "allow",
      "Action": "iam:ListPolicies",
      "Resource": "arn:aws:s3:::bucket-0/file-7.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_d65f509d",
      "Effect": "deny",
      "Action": "rds:DeleteDBInstance",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/eks:eks-cluster-name": "${aws:PrincipalTag/eks:eks-cluster-name}"
        },
        "StringLike": {
          "aws:RequestTag/eks:kubernetes-node-class-name": "*",
          "aws:RequestTag/eks:kubernetes-node-pool-name": "*"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_20ed6b79",
      "Effect": "allow",
      "Action": "iam:ListAttachedUserPolicies",
      "Resource": "arn:aws:glue:us-east-1:123456789012:table/db-18/table-20",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_776f2b48",
      "Effect": "deny",
      "Action": "ec2:DescribeInstances",
      "Resource": "arn:aws:s3:::admin-bucket/document.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/eks:eks-cluster-name": "${aws:PrincipalTag/eks:eks-cluster-name}"
        },
        "StringLike": {
          "aws:RequestTag/eks:kubernetes-node-class-name": "*",
          "aws:RequestTag/eks:kubernetes-node-pool-name": "*"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "allow_4858c4e2",
      "Effect": "allow",
      "Action": "iam:AddUserToGroup",
      "Resource": "arn:aws:glue:us-east-1:123456789012:table/db-1/table-1",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_697ff86b",
      "Effect": "deny",
      "Action": "ec2:ModifyInstanceAttribute",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/eks:eks-cluster-name": "${aws:PrincipalTag/eks:eks-cluster-name}"
        },
        "StringLike": {
          "aws:RequestTag/eks:kubernetes-node-class-name": "*",
          "aws:RequestTag/eks:kubernetes-node-pool-name": "*"
        }
      },
      "Principal": "arn:aws:iam::999888777666:user/unauthorized"
    },
    {
      "id": "deny_d6d23eb8",
      "Effect": "deny",
      "Action": "ec2:CreateSecurityGroup",
      "Resource": "arn:aws:kms:us-east-1:123456789012:key/09348485-1234-5678-90ab-cdef12345678",
      "Condition": {
        "StringEquals": {
          "aws:RequestTag/eks:eks-cluster-name": "${aws:PrincipalTag/eks:eks-cluster-name}"
        },
        "StringLike": {
          "aws:RequestTag/eks:kubernetes-node-class-name": "*",
          "aws:RequestTag/eks:kubernetes-node-pool-name": "*"
        }
      },
      "Principal": "arn:aws:iam::999888777666:user/unauthorized"
    },
    {
      "id": "allow_95114fb0",
      "Effect": "allow",
      "Action": "logs:FilterLogEvents",
      "Resource": "arn:aws:s3:::bucket-25/file-5.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_b89e93e1",
      "Effect": "allow",
      "Action": "cloudfront:CreateDistribution",
      "Resource": "arn:aws:s3:::bucket-43/file-5.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    }
  ]
}