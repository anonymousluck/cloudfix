{
  "Requests": [
    {
      "id": "deny_9e322cce",
      "Effect": "deny",
      "Action": "s3:DeleteBucketPolicy",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:HomeFolder}/*",
            "${transfer:HomeFolder}"
          ]
        }
      },
      "Principal": "arn:aws:iam::111222333444:user/david"
    },
    {
      "id": "allow_e5b603b3",
      "Effect": "allow",
      "Action": "codedeploy:ListDeployments",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-20-8.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_27d365ca",
      "Effect": "deny",
      "Action": "s3:GetBucketWebsite",
      "Resource": "arn:aws:s3:::denied-bucket-2/file-2.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:HomeFolder}/*",
            "${transfer:HomeFolder}"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/temp-user"
    },
    {
      "id": "allow_344f746e",
      "Effect": "allow",
      "Action": "autoscaling:CreateAutoScalingGroup",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-24-2.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_8f3c0618",
      "Effect": "allow",
      "Action": "iam:GetAccessKeyLastUsed",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-33-17.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_22ab3587",
      "Effect": "allow",
      "Action": "cloudtrail:CreateTrail",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-28-4.txt",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_d6e8b6a7",
      "Effect": "allow",
      "Action": "kms:GenerateDataKey",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-8-16.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "allow_0199c667",
      "Effect": "allow",
      "Action": "glue:GetCrawler",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-44-14.txt",
      "Condition": {
        "StringLike": {
          "aws:userid": "AIDAI"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    },
    {
      "id": "deny_f8b6c379",
      "Effect": "deny",
      "Action": "s3:GetBucketLifecycle",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}-forbidden/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:HomeFolder}/*",
            "${transfer:HomeFolder}"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/test-user"
    },
    {
      "id": "allow_e8d43fdb",
      "Effect": "allow",
      "Action": "kms:ListKeys",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-2-5.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "deny_211511b1",
      "Effect": "deny",
      "Action": "rds:CreateDBInstance",
      "Resource": "arn:aws:s3:::denied-bucket-1/file-1.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:HomeFolder}/*",
            "${transfer:HomeFolder}"
          ]
        }
      },
      "Principal": "arn:aws:iam::999888777666:user/unauthorized"
    },
    {
      "id": "deny_f2a526b9",
      "Effect": "deny",
      "Action": "s3:PutObjectTagging",
      "Resource": "arn:aws:s3:::different-${transfer:HomeDirectory}/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:HomeFolder}/*",
            "${transfer:HomeFolder}"
          ]
        }
      },
      "Principal": "arn:aws:iam::123456789012:role/service-role"
    },
    {
      "id": "allow_d4acbdd6",
      "Effect": "allow",
      "Action": "kms:ScheduleKeyDeletion",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-18-8.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-west-2"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/alice"
    },
    {
      "id": "deny_0569084c",
      "Effect": "deny",
      "Action": "s3:PutBucketWebsite",
      "Resource": "arn:aws:s3:::completely-different-bucket/file.txt",
      "Condition": {
        "StringLike": {
          "s3:prefix": [
            "${transfer:HomeFolder}/*",
            "${transfer:HomeFolder}"
          ]
        }
      },
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role"
    },
    {
      "id": "allow_26bf47c1",
      "Effect": "allow",
      "Action": "s3:DeleteObjectVersion",
      "Resource": "arn:aws:s3:::${transfer:HomeDirectory}/file-20-17.txt",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "us-east-1"
        }
      },
      "Principal": "arn:aws:iam::123456789012:user/bob"
    }
  ]
}