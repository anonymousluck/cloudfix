{
  "Requests": [
    {
      "id": "deny_0e6e544f",
      "Effect": "deny",
      "Action": "dynamodb:DeleteItem",
      "Resource": "forbidden-arn:aws:sns:eu-west-1:account-b-id:sns-topic-name-specific",
      "Principal": "arn:aws:iam::123456789012:role/admin-role",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": [
            "account-b-id",
            "account-a-id"
          ]
        }
      }
    },
    {
      "id": "allow_9b29b8c4",
      "Effect": "allow",
      "Action": "s3:GetBucketTagging",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name",
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    },
    {
      "id": "deny_839d878c",
      "Effect": "deny",
      "Action": "rds:CreateDBInstance",
      "Resource": "authorized/arn:aws:sns:eu-west-1:account-b-id:sns-topic-name/file.txt",
      "Principal": "arn:aws:iam::123456789012:user/alice",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": [
            "account-b-id",
            "account-a-id"
          ]
        }
      }
    },
    {
      "id": "allow_c4937655",
      "Effect": "allow",
      "Action": "cloudformation:UpdateStack",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name",
      "Principal": "arn:aws:iam::111222333444:user/temp-user",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": "not-['account-b-id', 'account-a-id']"
        }
      }
    },
    {
      "id": "allow_e84fc88e",
      "Effect": "allow",
      "Action": "athena:GetQueryResults",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name",
      "Principal": "arn:aws:iam::111222333444:user/temp-user",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": "not-['account-b-id', 'account-a-id']"
        }
      }
    },
    {
      "id": "allow_a6a725f4",
      "Effect": "allow",
      "Action": "sqs:ListQueueTags",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name",
      "Principal": "arn:aws:iam::123456789012:user/test-user",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "deny_68f3fcd1",
      "Effect": "deny",
      "Action": "lambda:CreateFunction",
      "Resource": "arn:aws:s3:::denied-bucket-0/file-0.txt",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": [
            "account-b-id",
            "account-a-id"
          ]
        }
      }
    },
    {
      "id": "deny_5231e091",
      "Effect": "deny",
      "Action": "iam:CreateUser",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name-forbidden-resource",
      "Principal": "arn:aws:iam::123456789012:role/test-role",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": [
            "account-b-id",
            "account-a-id"
          ]
        }
      }
    },
    {
      "id": "allow_032513b2",
      "Effect": "allow",
      "Action": "athena:GetQueryResultsStream",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name",
      "Principal": "arn:aws:iam::123456789012:user/blocked-user",
      "Condition": {
        "StringEquals": {
          "aws:RequestedRegion": "eu-west-1"
        }
      }
    },
    {
      "id": "allow_b1d52c74",
      "Effect": "allow",
      "Action": "s3:DeleteObjectTagging",
      "Resource": "arn:aws:sns:eu-west-1:account-b-id:sns-topic-name",
      "Principal": "arn:aws:iam::555666777888:role/cross-account-role",
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    }
  ]
}